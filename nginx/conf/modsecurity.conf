# Enable ModSecurity
SecRuleEngine On

# Enable request body inspection
SecRequestBodyAccess On
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 64000
SecRequestBodyLimitAction Reject

# Enable response body inspection
SecResponseBodyAccess Off
SecResponseBodyLimit 524288

# Allow ModSecurity to inspect POST data
SecArgumentSeparator &
SecCookieFormat 0

# Log all relevant data
SecAuditEngine On
SecAuditLogRelevantStatus "^(?:5|4(?!04))"
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial
SecAuditLog /var/log/modsec_audit.log
SecAuditLogFormat JSON

# Disable encoding
SecResponseBodyMimeType (null) text/html text/plain text/xml

# Block common attack vectors
SecRule ARGS "@rx <script>" "id:12345,phase:2,deny,status:403,msg:'XSS attack detected'"
SecRule ARGS "@rx union.*select.*from" "id:12346,phase:2,deny,status:403,msg:'SQL Injection detected'"